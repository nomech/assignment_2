!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports&&"function"==typeof require?require("jquery"):jQuery)}((function(e){"use strict";function t(n,o){const s=this;s.element=n,s.el=e(n),s.suggestions=[],s.badQueries=[],s.selectedIndex=-1,s.currentValue=s.element.value,s.timeoutId=null,s.cachedResponse={},s.onChangeTimeout=null,s.onChange=null,s.isLocal=!1,s.suggestionsContainer=null,s.noSuggestionsContainer=null,s.options=e.extend(!0,{},t.defaults,o),s.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},s.hint=null,s.hintValue="",s.selection=null,s.initialize(),s.setOptions(o)}var n={escapeRegExChars(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},createNode(e){const t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t}},o=e.noop;t.utils=n,e.Autocomplete=t,t.defaults={ajaxSettings:{},autoSelectFirst:!1,appendTo:"body",serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:function(e,t){if(!t)return e.value;const o="("+n.escapeRegExChars(t)+")";return e.value.replace(new RegExp(o,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},formatGroup:function(e,t){return'<div class="autocomplete-group">'+t+"</div>"},delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:o,onSearchComplete:o,onSearchError:o,preserveInput:!1,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(e,t,n){return-1!==e.value.toLowerCase().indexOf(n)},paramName:"query",transformResult:function(t){return"string"==typeof t?e.parseJSON(t):t},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1},t.prototype={initialize(){let n,o=this,s="."+o.classes.suggestion,i=o.classes.selected,l=o.options;o.element.setAttribute("autocomplete","off"),o.noSuggestionsContainer=e('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),o.suggestionsContainer=t.utils.createNode(l.containerClass),n=e(o.suggestionsContainer),n.appendTo(l.appendTo||"body"),"auto"!==l.width&&n.css("width",l.width),n.on("mouseover.autocomplete",s,(function(){o.activate(e(this).data("index"))})),n.on("mouseout.autocomplete",(function(){o.selectedIndex=-1,n.children("."+i).removeClass(i)})),n.on("click.autocomplete",s,(function(){o.select(e(this).data("index"))})),n.on("click.autocomplete",(function(){clearTimeout(o.blurTimeoutId)})),o.fixPositionCapture=function(){o.visible&&o.fixPosition()},e(window).on("resize.autocomplete",o.fixPositionCapture),o.el.on("keydown.autocomplete",(function(e){o.onKeyPress(e)})),o.el.on("keyup.autocomplete",(function(e){o.onKeyUp(e)})),o.el.on("blur.autocomplete",(function(){o.onBlur()})),o.el.on("focus.autocomplete",(function(){o.onFocus()})),o.el.on("change.autocomplete",(function(e){o.onKeyUp(e)})),o.el.on("input.autocomplete",(function(e){o.onKeyUp(e)}))},onFocus(){const e=this;e.fixPosition(),e.el.val().length>=e.options.minChars&&e.onValueChange()},onBlur(){const t=this,n=t.options,o=t.el.val(),s=t.getQuery(o);t.blurTimeoutId=setTimeout((function(){t.hide(),t.selection&&t.currentValue!==s&&(n.onInvalidateSelection||e.noop).call(t.element)}),200)},abortAjax(){const e=this;e.currentRequest&&(e.currentRequest.abort(),e.currentRequest=null)},setOptions(t){const n=this,o=e.extend({},n.options,t);n.isLocal=Array.isArray(o.lookup),n.isLocal&&(o.lookup=n.verifySuggestionsFormat(o.lookup)),o.orientation=n.validateOrientation(o.orientation,"bottom"),e(n.suggestionsContainer).css({"max-height":o.maxHeight+"px",width:o.width+"px","z-index":o.zIndex}),this.options=o},clearCache(){this.cachedResponse={},this.badQueries=[]},clear(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable(){const e=this;e.disabled=!0,clearTimeout(e.onChangeTimeout),e.abortAjax()},enable(){this.disabled=!1},fixPosition(){const t=this,n=e(t.suggestionsContainer),o=n.parent().get(0);if(o===document.body||t.options.forceFixPosition){let s=t.options.orientation,i=n.outerHeight(),l=t.el.outerHeight(),a=t.el.offset(),u={top:a.top,left:a.left};if("auto"===s){const t=e(window).height(),n=e(window).scrollTop(),o=-n+a.top-i,u=n+t-(a.top+l+i);s=Math.max(o,u)===o?"top":"bottom"}if(u.top+="top"===s?-i:l,o!==document.body){let e,s=n.css("opacity");t.visible||n.css("opacity",0).show(),e=n.offsetParent().offset(),u.top-=e.top,u.top+=o.scrollTop,u.left-=e.left,t.visible||n.css("opacity",s).hide()}"auto"===t.options.width&&(u.width=t.el.outerWidth()+"px"),n.css(u)}},isCursorAtEnd(){let e,t=this.el.val().length,n=this.element.selectionStart;return"number"==typeof n?n===t:!document.selection||(e=document.selection.createRange(),e.moveStart("character",-t),t===e.text.length)},onKeyPress(e){const t=this;if(t.disabled||t.visible||40!==e.which||!t.currentValue){if(!t.disabled&&t.visible){switch(e.which){case 27:t.el.val(t.currentValue),t.hide();break;case 39:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case 9:if(t.hint&&t.options.onHint)return void t.selectHint();if(-1===t.selectedIndex)return void t.hide();if(t.select(t.selectedIndex),!1===t.options.tabDisabled)return;break;case 13:if(-1===t.selectedIndex)return void t.hide();t.select(t.selectedIndex);break;case 38:t.moveUp();break;case 40:t.moveDown();break;default:return}e.stopImmediatePropagation(),e.preventDefault()}}else t.suggest()},onKeyUp(e){const t=this;if(!t.disabled){switch(e.which){case 38:case 40:return}clearTimeout(t.onChangeTimeout),t.currentValue!==t.el.val()&&(t.findBestHint(),t.options.deferRequestBy>0?t.onChangeTimeout=setTimeout((function(){t.onValueChange()}),t.options.deferRequestBy):t.onValueChange())}},onValueChange(){if(this.ignoreValueChange)return void(this.ignoreValueChange=!1);const t=this,n=t.options,o=t.el.val(),s=t.getQuery(o);return t.selection&&t.currentValue!==s&&(t.selection=null,(n.onInvalidateSelection||e.noop).call(t.element)),clearTimeout(t.onChangeTimeout),t.currentValue=o,t.selectedIndex=-1,n.triggerSelectOnValidInput&&t.isExactMatch(s)?void t.select(0):void(s.length<n.minChars?t.hide():t.getSuggestions(s))},isExactMatch(e){const t=this.suggestions;return 1===t.length&&t[0].value.toLowerCase()===e.toLowerCase()},getQuery(t){let n,o=this.options.delimiter;return o?(n=t.split(o),e.trim(n[n.length-1])):t},getSuggestionsLocal(t){let n,o=this.options,s=t.toLowerCase(),i=o.lookupFilter,l=parseInt(o.lookupLimit,10);return n={suggestions:e.grep(o.lookup,(function(e){return i(e,t,s)}))},l&&n.suggestions.length>l&&(n.suggestions=n.suggestions.slice(0,l)),n},getSuggestions(t){let n,o,s,i,l=this,a=l.options,u=a.serviceUrl;if(a.params[a.paramName]=t,!1!==a.onSearchStart.call(l.element,a.params)){if(o=a.ignoreParams?null:a.params,e.isFunction(a.lookup))return void a.lookup(t,(function(e){l.suggestions=e.suggestions,l.suggest(),a.onSearchComplete.call(l.element,t,e.suggestions)}));l.isLocal?n=l.getSuggestionsLocal(t):(e.isFunction(u)&&(u=u.call(l.element,t)),s=u+"?"+e.param(o||{}),n=l.cachedResponse[s]),n&&Array.isArray(n.suggestions)?(l.suggestions=n.suggestions,l.suggest(),a.onSearchComplete.call(l.element,t,n.suggestions)):l.isBadQuery(t)?a.onSearchComplete.call(l.element,t,[]):(l.abortAjax(),i={url:u,data:o,type:a.type,dataType:a.dataType},e.extend(i,a.ajaxSettings),l.currentRequest=e.ajax(i).done((function(e){let n;l.currentRequest=null,n=a.transformResult(e,t),l.processResponse(n,t,s),a.onSearchComplete.call(l.element,t,n.suggestions)})).fail((function(e,n,o){a.onSearchError.call(l.element,t,e,n,o)})))}},isBadQuery(e){if(!this.options.preventBadQueries)return!1;for(let t=this.badQueries,n=t.length;n--;)if(0===e.indexOf(t[n]))return!0;return!1},hide(){const t=this,n=e(t.suggestionsContainer);e.isFunction(t.options.onHide)&&t.visible&&t.options.onHide.call(t.element,n),t.visible=!1,t.selectedIndex=-1,clearTimeout(t.onChangeTimeout),e(t.suggestionsContainer).hide(),t.signalHint(null)},suggest(){if(!this.suggestions.length)return void(this.options.showNoSuggestionNotice?this.noSuggestions():this.hide());let t,n=this,o=n.options,s=o.groupBy,i=o.formatResult,l=n.getQuery(n.currentValue),a=n.classes.suggestion,u=n.classes.selected,r=e(n.suggestionsContainer),c=e(n.noSuggestionsContainer),g=o.beforeRender,d="",p=function(e,n){const i=e.data[s];return t===i?"":(t=i,o.formatGroup(e,t))};return o.triggerSelectOnValidInput&&n.isExactMatch(l)?void n.select(0):(e.each(n.suggestions,(function(e,t){s&&(d+=p(t)),d+='<div class="'+a+'" data-index="'+e+'">'+i(t,l,e)+"</div>"})),this.adjustContainerWidth(),c.detach(),r.html(d),e.isFunction(g)&&g.call(n.element,r,n.suggestions),n.fixPosition(),r.show(),o.autoSelectFirst&&(n.selectedIndex=0,r.scrollTop(0),r.children("."+a).first().addClass(u)),n.visible=!0,void n.findBestHint())},noSuggestions(){const t=this,n=t.options.beforeRender,o=e(t.suggestionsContainer),s=e(t.noSuggestionsContainer);this.adjustContainerWidth(),s.detach(),o.empty(),o.append(s),e.isFunction(n)&&n.call(t.element,o,t.suggestions),t.fixPosition(),o.show(),t.visible=!0},adjustContainerWidth(){let t,n=this,o=n.options,s=e(n.suggestionsContainer);"auto"===o.width?(t=n.el.outerWidth(),s.css("width",t>0?t:300)):"flex"===o.width&&s.css("width","")},findBestHint(){let t=this,n=t.el.val().toLowerCase(),o=null;n&&(e.each(t.suggestions,(function(e,t){const s=0===t.value.toLowerCase().indexOf(n);return s&&(o=t),!s})),t.signalHint(o))},signalHint(t){let n="",o=this;t&&(n=o.currentValue+t.value.substr(o.currentValue.length)),o.hintValue!==n&&(o.hintValue=n,o.hint=t,(this.options.onHint||e.noop)(n))},verifySuggestionsFormat(t){return t.length&&"string"==typeof t[0]?e.map(t,(function(e){return{value:e,data:null}})):t},validateOrientation(t,n){return t=e.trim(t||"").toLowerCase(),-1===e.inArray(t,["auto","bottom","top"])&&(t=n),t},processResponse(e,t,n){const o=this,s=o.options;e.suggestions=o.verifySuggestionsFormat(e.suggestions),s.noCache||(o.cachedResponse[n]=e,s.preventBadQueries&&!e.suggestions.length&&o.badQueries.push(t)),t===o.getQuery(o.currentValue)&&(o.suggestions=e.suggestions,o.suggest())},activate(t){let n,o=this,s=o.classes.selected,i=e(o.suggestionsContainer),l=i.find("."+o.classes.suggestion);return i.find("."+s).removeClass(s),o.selectedIndex=t,-1!==o.selectedIndex&&l.length>o.selectedIndex?(n=l.get(o.selectedIndex),e(n).addClass(s),n):null},selectHint(){const t=this,n=e.inArray(t.hint,t.suggestions);t.select(n)},select(e){this.hide(),this.onSelect(e)},moveUp(){const t=this;if(-1!==t.selectedIndex)return 0===t.selectedIndex?(e(t.suggestionsContainer).children("."+t.classes.suggestion).first().removeClass(t.classes.selected),t.selectedIndex=-1,t.ignoreValueChange=!1,t.el.val(t.currentValue),void t.findBestHint()):void t.adjustScroll(t.selectedIndex-1)},moveDown(){const e=this;e.selectedIndex!==e.suggestions.length-1&&e.adjustScroll(e.selectedIndex+1)},adjustScroll(t){const n=this,o=n.activate(t);if(o){let s,i,l,a=e(o).outerHeight();s=o.offsetTop,i=e(n.suggestionsContainer).scrollTop(),l=i+n.options.maxHeight-a,s<i?e(n.suggestionsContainer).scrollTop(s):s>l&&e(n.suggestionsContainer).scrollTop(s-n.options.maxHeight+a),n.options.preserveInput||(n.ignoreValueChange=!0,n.el.val(n.getValue(n.suggestions[t].value))),n.signalHint(null)}},onSelect(t){const n=this,o=n.options.onSelect,s=n.suggestions[t];n.currentValue=n.getValue(s.value),n.currentValue===n.el.val()||n.options.preserveInput||n.el.val(n.currentValue),n.signalHint(null),n.suggestions=[],n.selection=s,e.isFunction(o)&&o.call(n.element,s)},getValue(e){let t,n,o=this.options.delimiter;return o?(t=this.currentValue,n=t.split(o),1===n.length?e:t.substr(0,t.length-n[n.length-1].length)+e):e},dispose(){const t=this;t.el.off(".autocomplete").removeData("autocomplete"),e(window).off("resize.autocomplete",t.fixPositionCapture),e(t.suggestionsContainer).remove()}},e.fn.devbridgeAutocomplete=function(n,o){const s="autocomplete";return arguments.length?this.each((function(){let i=e(this),l=i.data(s);"string"==typeof n?l&&"function"==typeof l[n]&&l[n](o):(l&&l.dispose&&l.dispose(),l=new t(this,n),i.data(s,l))})):this.first().data(s)},e.fn.autocomplete||(e.fn.autocomplete=e.fn.devbridgeAutocomplete)}));